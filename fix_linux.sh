#!/bin/bash
echo "This script only works if your Log4J2 is 2.10+ version."
if [ $USER == "root" ]; then
    echo "Apply patches for user ALL (root-mode)..."
    echo -e "# CVE-2021-44228 - Generated by script.\nLOG4J_FORMAT_MSG_NO_LOOKUPS=true" >> /etc/bashrc
    echo -e "# CVE-2021-44228 - Generated by script.\nLOG4J_FORMAT_MSG_NO_LOOKUPS=true" >> ~/.bashrc
    echo Successfully apply patches to all users.
else 
    echo "Apply patches for user $USER (user-mode)"
    echo -e "# CVE-2021-44228 - Generated by script.\nLOG4J_FORMAT_MSG_NO_LOOKUPS=true" >> ~/.bashrc
    echo Successfully apply patches to $USER user.
fi
source /etc/bashrc
source ~/.bashrc
echo Successfully source the bashrc files.
